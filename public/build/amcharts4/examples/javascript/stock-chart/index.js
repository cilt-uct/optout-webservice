am4core.useTheme(am4themes_animated);var chart=am4core.create("chartdiv",am4charts.XYChart);chart.padding(0,15,0,15),chart.dataSource.url="https://www.amcharts.com/wp-content/uploads/assets/stock/MSFT.csv",chart.dataSource.parser=new am4core.CSVParser,chart.dataSource.parser.options.useColumnNames=!0,chart.dataSource.parser.options.reverse=!0,chart.leftAxesContainer.layout="vertical";var dateAxis=chart.xAxes.push(new am4charts.DateAxis);dateAxis.renderer.grid.template.location=0,dateAxis.renderer.ticks.template.length=8,dateAxis.renderer.ticks.template.strokeOpacity=.1,dateAxis.renderer.grid.template.disabled=!0,dateAxis.renderer.ticks.template.disabled=!1,dateAxis.renderer.ticks.template.strokeOpacity=.2,dateAxis.renderer.minLabelPosition=.01,dateAxis.renderer.maxLabelPosition=.99,dateAxis.keepSelection=!0,dateAxis.minHeight=30,dateAxis.groupData=!0,dateAxis.minZoomCount=5;var valueAxis=chart.yAxes.push(new am4charts.ValueAxis);valueAxis.tooltip.disabled=!0,valueAxis.zIndex=1,valueAxis.renderer.baseGrid.disabled=!0,valueAxis.height=am4core.percent(65),valueAxis.renderer.gridContainer.background.fill=am4core.color("#000000"),valueAxis.renderer.gridContainer.background.fillOpacity=.05,valueAxis.renderer.inside=!0,valueAxis.renderer.labels.template.verticalCenter="bottom",valueAxis.renderer.labels.template.padding(2,2,2,2),valueAxis.renderer.fontSize="0.8em";var series=chart.series.push(new am4charts.LineSeries);series.dataFields.dateX="Date",series.dataFields.valueY="Adj Close",series.tooltipText="{valueY.value}",series.name="MSFT: Value",series.defaultState.transitionDuration=0;var valueAxis2=chart.yAxes.push(new am4charts.ValueAxis);valueAxis2.tooltip.disabled=!0,valueAxis2.height=am4core.percent(35),valueAxis2.zIndex=3,valueAxis2.marginTop=30,valueAxis2.renderer.baseGrid.disabled=!0,valueAxis2.renderer.inside=!0,valueAxis2.renderer.labels.template.verticalCenter="bottom",valueAxis2.renderer.labels.template.padding(2,2,2,2),valueAxis2.renderer.fontSize="0.8em",valueAxis2.renderer.gridContainer.background.fill=am4core.color("#000000"),valueAxis2.renderer.gridContainer.background.fillOpacity=.05;var series2=chart.series.push(new am4charts.ColumnSeries);series2.dataFields.dateX="Date",series2.dataFields.valueY="Volume",series2.yAxis=valueAxis2,series2.tooltipText="{valueY.value}",series2.name="MSFT: Volume",series2.groupFields.valueY="sum",series2.defaultState.transitionDuration=0,chart.cursor=new am4charts.XYCursor;var scrollbarX=new am4charts.XYChartScrollbar;scrollbarX.series.push(series),scrollbarX.marginBottom=20,scrollbarX.scrollbarChart.xAxes.getIndex(0).minHeight=void 0,chart.scrollbarX=scrollbarX;var zoomTimeout,inputFieldFormat="yyyy-MM-dd";function updateFields(){var e=dateAxis.minZoomed+.5*am4core.time.getDuration(dateAxis.mainBaseInterval.timeUnit,dateAxis.mainBaseInterval.count);document.getElementById("fromfield").value=chart.dateFormatter.format(e,inputFieldFormat),document.getElementById("tofield").value=chart.dateFormatter.format(new Date(dateAxis.maxZoomed),inputFieldFormat)}function updateZoom(){zoomTimeout&&clearTimeout(zoomTimeout),zoomTimeout=setTimeout((function(){var e=document.getElementById("fromfield").value,t=document.getElementById("tofield").value;if(!(e.length<inputFieldFormat.length||t.length<inputFieldFormat.length)){var a=chart.dateFormatter.parse(e,inputFieldFormat),r=chart.dateFormatter.parse(t,inputFieldFormat);a&&r&&dateAxis.zoomToDates(a,r)}}),500)}function zoomToDates(e){var t=dateAxis.groupMin.day1,a=dateAxis.groupMax.day1;dateAxis.keepSelection=!0,dateAxis.zoom({start:(e.getTime()-t)/(a-t),end:1})}document.getElementById("b1m").addEventListener("click",(function(){var e=dateAxis.groupMax.day1,t=new Date(e);am4core.time.add(t,"month",-1),zoomToDates(t)})),document.getElementById("b3m").addEventListener("click",(function(){var e=dateAxis.groupMax.day1,t=new Date(e);am4core.time.add(t,"month",-3),zoomToDates(t)})),document.getElementById("b6m").addEventListener("click",(function(){var e=dateAxis.groupMax.day1,t=new Date(e);am4core.time.add(t,"month",-6),zoomToDates(t)})),document.getElementById("b1y").addEventListener("click",(function(){var e=dateAxis.groupMax.day1,t=new Date(e);am4core.time.add(t,"year",-1),zoomToDates(t)})),document.getElementById("bytd").addEventListener("click",(function(){var e=dateAxis.groupMax.day1,t=new Date(e);am4core.time.round(t,"year",1),zoomToDates(t)})),document.getElementById("bmax").addEventListener("click",(function(){var e=dateAxis.groupMin.day1;zoomToDates(new Date(e))})),dateAxis.events.on("selectionextremeschanged",(function(){updateFields()})),dateAxis.events.on("extremeschanged",updateFields),document.getElementById("fromfield").addEventListener("keyup",updateZoom),document.getElementById("tofield").addEventListener("keyup",updateZoom);