am4core.useTheme(am4themes_animated);var chart=am4core.create("chartdiv",am4maps.MapChart);try{chart.geodata=am4geodata_worldLow}catch(e){chart.raiseCriticalError(new Error('Map geodata could not be loaded. Please download the latest <a href="https://www.amcharts.com/download/download-v4/">amcharts geodata</a> and extract its contents into the same directory as your amCharts files.'))}chart.projection=new am4maps.projections.Mercator,chart.chartContainer.background.events.on("hit",(function(){zoomOut()}));var morphedPolygon,colorSet=new am4core.ColorSet,polygonSeries=chart.series.push(new am4maps.MapPolygonSeries);polygonSeries.useGeodata=!0,polygonSeries.include=["IT","CH","FR","DE","GB","ES","PT","IE","NL","LU","BE","AT","DK"];var polygonTemplate=polygonSeries.mapPolygons.template;polygonTemplate.strokeOpacity=1,polygonTemplate.stroke=am4core.color("#ffffff"),polygonTemplate.fillOpacity=.5,polygonTemplate.tooltipText="{name}";var desaturateFilter=new am4core.DesaturateFilter;desaturateFilter.saturation=.25,polygonTemplate.filters.push(desaturateFilter),polygonTemplate.adapter.add("fill",(function(e,t){return colorSet.getIndex(t.dataItem.index+1)}));var hoverState=polygonTemplate.states.create("hover");hoverState.properties.fillOpacity=1,polygonTemplate.events.on("hit",(function(e){e.target.zIndex=Number.MAX_VALUE,selectPolygon(e.target)}));var pieChart=chart.seriesContainer.createChild(am4charts.PieChart);pieChart.width=100,pieChart.height=100,pieChart.hidden=!0,pieChart.chartContainer.minHeight=1,pieChart.chartContainer.minWidth=1;var pieSeries=pieChart.series.push(new am4charts.PieSeries);pieSeries.dataFields.value="value",pieSeries.dataFields.category="category",pieSeries.data=[{value:100,category:"First"},{value:20,category:"Second"},{value:10,category:"Third"}];var dropShadowFilter=new am4core.DropShadowFilter;dropShadowFilter.blur=4,pieSeries.filters.push(dropShadowFilter);var sliceTemplate=pieSeries.slices.template;sliceTemplate.fillOpacity=1,sliceTemplate.strokeOpacity=0;var activeState=sliceTemplate.states.getKey("active");activeState.properties.shiftRadius=0;var sliceHoverState=sliceTemplate.states.getKey("hover");sliceHoverState.properties.shiftRadius=0;var hiddenState=pieSeries.hiddenState;hiddenState.properties.startAngle=pieSeries.startAngle,hiddenState.properties.endAngle=pieSeries.endAngle,hiddenState.properties.opacity=0,hiddenState.properties.visible=!1;var labelTemplate=pieSeries.labels.template;labelTemplate.nonScaling=!0,labelTemplate.fill=am4core.color("#FFFFFF"),labelTemplate.fontSize=10,labelTemplate.background=new am4core.RoundedRectangle,labelTemplate.background.fillOpacity=.9,labelTemplate.padding(4,9,4,9),labelTemplate.background.fill=am4core.color("#7678a0"),pieSeries.hiddenState.transitionDuration=200;var countryLabel=chart.chartContainer.createChild(am4core.Label);function selectPolygon(e){if(morphedPolygon!=e){var t=pieSeries.hide();t?t.events.on("animationended",(function(){morphToCircle(e)})):morphToCircle(e)}}function fadeOut(e){for(var t=0;t<polygonSeries.mapPolygons.length;t++){var a=polygonSeries.mapPolygons.getIndex(t);a!=e&&(a.defaultState.properties.fillOpacity=.5,a.animate([{property:"fillOpacity",to:.5},{property:"strokeOpacity",to:1}],a.polygon.morpher.morphDuration))}}function zoomOut(){morphedPolygon&&(pieSeries.hide(),morphBack(),fadeOut(),countryLabel.hide(),morphedPolygon=void 0)}function morphBack(){morphedPolygon&&(morphedPolygon.polygon.morpher.morphBack(),morphedPolygon.filters.getIndex(0).animate({property:"saturation",to:.25},morphedPolygon.polygon.morpher.morphDuration))}function morphToCircle(e){var t=e.polygon.morpher.morphDuration;morphBack(),e.toFront(),e.polygon.morpher.morphToSingle=!0;var a=e.polygon.morpher.morphToCircle();e.strokeOpacity=0,e.defaultState.properties.fillOpacity=1,e.animate({property:"fillOpacity",to:1},t),e.filters.getIndex(0).animate({property:"saturation",to:1},t),morphedPolygon=e,fadeOut(e),countryLabel.hide(),a?a.events.on("animationended",(function(){zoomToCountry(e)})):zoomToCountry(e)}function zoomToCountry(e){var t=chart.zoomToMapObject(e,2,!0);t?t.events.on("animationended",(function(){showPieChart(e)})):showPieChart(e)}function showPieChart(e){e.polygon.measure();var t=e.polygon.measuredWidth/2*e.globalScale/chart.seriesContainer.scale;pieChart.width=2*t,pieChart.height=2*t,pieChart.radius=t;var a=am4core.utils.spritePointToSvg(e.polygon.centerPoint,e.polygon);a=am4core.utils.svgPointToSprite(a,chart.seriesContainer),pieChart.x=a.x-t,pieChart.y=a.y-t;for(var o=e.fill,r=o.saturate(.3),i=0;i<pieSeries.dataItems.length;i++){var l=pieSeries.dataItems.getIndex(i);l.value=Math.round(100*Math.random()),l.slice.fill=am4core.color(am4core.colors.interpolate(o.rgb,am4core.color("#ffffff").rgb,.2*i)),l.label.background.fill=r,l.tick.stroke=o}pieSeries.show(),pieChart.show(),countryLabel.text="{name}",countryLabel.dataItem=e.dataItem,countryLabel.fill=r,countryLabel.show()}countryLabel.text="Select a country",countryLabel.fill=am4core.color("#7678a0"),countryLabel.fontSize=40,countryLabel.hiddenState.properties.dy=1e3,countryLabel.defaultState.properties.dy=0,countryLabel.valign="middle",countryLabel.align="right",countryLabel.paddingRight=50,countryLabel.hide(0),countryLabel.show();