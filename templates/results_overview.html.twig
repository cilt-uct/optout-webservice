{% include 'html_start.html' %}
    <div class="content">
        {% include 'header.html' %}
        <a name="top" class="anchor"></a>
        <div class="container post">
            {% include 'header_nav.html' %}
            <div class="row post-body">
                <div class="col-md-12 post-title">
                    <h3><span style="color: #5caad2;">Student Access Survey:</span> Overview</h3>
                    <br/>
                    <div id="main-table" class="workflow-details">
                        <!--p>{{authenticated|json_encode()}}</p-->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="{{ asset('public/build/app.js') }}"></script>
    <script src="{{ asset('public/build/js/jquery.min.js') }}"></script>
    <script src="{{ asset('public/build/js/moment.min.js') }}"></script>
    <script src="{{ asset('public/build/js/tmpl.js') }}"></script>
    <script src="{{ asset('public/build/js/utils.js') }}"></script>
    <script>
        var options = { "page": 1, "limit": 15, "filter": "", "order": "code,asc", "max": 0, "type": "all", "state":"all", "batch": 0};

        function showTable() {
            var $order = options.order,
                $current = options.page,
                $limit = options.limit,
                $filter = options.filter;
                $type = options.type;
                $state = options.state;

            console.log(options);
            $.ajax({
                url: "/optout/api/v0/dass/?page="+$current
                                    +($order!=""?"&order="+$order:"")
                                    +($limit!=""?"&limit="+$limit:"")
                                    +($type!=""?"&type="+$type:"")
                                    +($state!=""?"&state="+$state:"")
                                    +($filter!=""?"&filter="+encodeURI($filter):""),
                method: 'GET',
                dataType: 'json'
            }).done(function(data) {
                console.log(data);
                options.max = Math.ceil(data.total / data.limit);
                if(isNaN(options.max)) { options.max = 0; }
                $('#main-table').html(tmpl('tmpl-table', data))
            }).fail(function(xhr) {
                console.log(xhr);
            });
        }

        $(function() {
            showTable();
        });
    </script>
    {{ source('results_overview_template.html') }}
{% include 'footer.html' %}
{% include 'html_end.html' %}