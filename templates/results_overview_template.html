<script type="text/x-tmpl" id="tmpl-table">
    {% var current = Math.ceil(o.offset / o.limit); if (isNaN(current)) { current = 1; }
           total_pages = Math.ceil(o.total / o.limit); if (isNaN(total_pages)) { total_pages = 1; } %}

    <table class="main-tbl" data-current="{%=(current+1)%}" data-total="{%=o.total%}" data-offset="{%=o.offset%}" data-count="{%=o.count%}" data-limit="{%=o.limit%}">
        <thead>
            <tr>
                <th style="width: 260px;" class="sort {%=sort_dir(o.order,'code')%}" data-rel="code">
                    <span>
                        Code
                        <i></i>
                    </span>
                </th>
                <th style="width: 220px;" class="sort {%=sort_dir(o.order,'convener')%}" data-rel="convener">
                    <span>
                        Convener(s)
                        <i></i>
                    </span>
                </th>
                <th style="width: 140px;" class="sort {%=sort_dir(o.order,'updated_at')%}" data-rel="updated_at">
                    <span>
                        Last Updated
                        <i></i>
                    </span>
                </th>
                <th style="width: 96px;" class="sort {%=sort_dir(o.order,'type')%}" data-rel="type">
                    <span>
                        type
                        <i></i>
                    </span>
                </th>                
                <th style="width: 96px;" class="sort {%=sort_dir(o.order,'state')%}" data-rel="state">
                    <span>
                        State
                        <i></i>
                    </span>
                </th>
                <th style="width: 96px;">
                    <span>
                        Actions
                        <i></i>
                    </span>
                </th>
            </tr>
        </thead>
        <tbody>
            {%  if (o.result) {
                    include('tmpl-row', o.result);
                } else {
                    include('tmpl-row-loading', {});
                }
            %}
        </tbody>
    </table>
    <div class="row">
        <div class="col-md-8">
            <!--p>{%=total_pages%} - {%=current%} ({%=o.offset%}) - {%=o.count%} - {%=o.limit%}</p-->
            <nav aria-label="Page navigation example">
                <ul class="pagination">
                    <li class="page-item">
                        <a class="page-link {% if (current == 1){ print("disabled"); } %}" {% if (current == 1){ %}aria-disabled="true"{% } %} href="#" id="page_prev" rel="prev" data-add="-1"><i class="fas fa-chevron-left"></i></a></li>
                    {% $.each( pages(o.total, o.offset, o.limit), function( i, v ) { %}
                        <li class="page-item{%=(isNaN(v)?' disabled': (v==(current+1)?' active':''))%}"><a class="page-link" href="#" rel='{%=(isNaN(v)?'spacer':v)%}'>{%=v%}</a></li>
                    {% }); %}
                    <li class="page-item">
                        <a class="page-link {% if (current == total_pages){ print("disabled"); } %}" {% if (current == 1){ %}aria-disabled="true"{% } %} href="#" id="page_next" rel="next" data-add="1"><i class="fas fa-chevron-right"></i></a></li>
                </ul>
            </nav>
        </div>
        <!--div class="col-md-4 text-right">
            <select>
                {% $.each([10, 20, 50, 100], function( i, v ) { %}
                <option value="{%=v%}">{%=v%}</option>
                {% }); %}
            </select>
        </div-->
    </div>
</script>

<script type="text/x-tmpl" id="tmpl-row">
    {% if (o.length == 0) { %}
    <tr>
        <td colspan="6">No entries found matching search criteria.</td>
    </tr>
    {% } else {
        $.each(o, function( i, row ) { %}
    <tr>
        <td>{%=row.code%}</td>
        <td>{%=row.mail_name%} %=row.mail_to%}</td>
        <td>{%=row.hash%}</td>
        <td>{%=row.state%}</td>
        <td>{%=row.type%}</td>
        <td>&nbsp;</td>        
    </tr>
    {% } ); } %}
</script>

<script type="text/x-tmpl" id="tmpl-row-loading">
    <tr>
        <td colspan="8">
            <i class="fas fa-cog fa-spin fa-2x"></i>
            <span style="display: inline-block; position: relative; left: 10px;top: -5px;">Loading results...</span>
        </td>
    </tr>
</script>
